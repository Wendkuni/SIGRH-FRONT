
<p-card  styleClass="mb-5">
  <p-toolbar>
    <ng-template pTemplate="right">
      <div class="my-2">
        <!--        Button d'ajout d'un couriel -->
        <button
          pButton
          pRipple
          label="Ajouter"
          icon="pi pi-plus"
          class="p-element p-ripple p-button-outlined p-button-primary p-button p-component mr-2"
          (click)="showForm()"
        ></button>
      </div>
    </ng-template>
    <ng-template pTemplate="left">
      <div class="my-2">
        <h4>Gestion du couriel</h4>
      </div>
    </ng-template>
  </p-toolbar>
</p-card>
<!-- Toolbar end-->

<!-- Table start-->
<p-card>
  <!--  Tableau d'affichage de la liste du personnel -->
  <p-table
    [columns]="cols"
    [value]="listCouriers$"
    #dt1
    dataKey="id"
    [rows]="5"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Page {currentPage} sur {totalPages}"
    [paginator]="true"
    styleClass="p-datatable-gridlines p-datatable-striped"
    responsiveLayout="scroll"
    [rowHover]="true"
    [rowsPerPageOptions]="[5,10, 20]"
    tableStyleClass="p-datatable-gridlines"
    [globalFilterFields]="['libelle','type','source','categorie','designation','ventilation','dateVentilation','object','numDoc','annotation','se','dateCouriel']"
  >
    <ng-template pTemplate="caption">
      <div class="flex justify-content-between flex-column sm:flex-row">
              <span class="p-input-icon-left mb-2">
							<i class="pi pi-search"></i>
							<input pInputText type="text" #filter placeholder="Recherche..." class="w-full"/>
						</span>
      </div>
    </ng-template>
    <ng-template let-columns pTemplate="header">
      <tr>
        @for (col of columns; track col.field) {
          <th
            style="min-width: 15rem"
            [pSortableColumn]="col.field"
            class="font-weight-bold"
          >
            {{ col.header }}
            <p-sortIcon [field]="col.field"></p-sortIcon>
          </th>
        }
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-couriel>
      <tr>
        <td>{{couriel.libelle}}</td>
        <td>{{couriel.type}}</td>
        <td>{{couriel.source}}</td>
        <td>{{couriel.sens}}</td>
        <td>{{couriel.categorie}}</td>
        <td>{{couriel.observation}}</td>
        <td>{{couriel.designation}}</td>
        <td>{{couriel.ventilation}}</td>
        <td>{{couriel.dateVentilation | date}}</td>
        <td>{{couriel.object}}</td>
        <td>{{couriel.numDoc}}</td>
        <td>{{couriel.annotation}}</td>
        <td>{{couriel.se}}</td>
        <td>{{couriel.dateCouriel | date}}</td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="8">Aucun Ã©lement.</td>
      </tr>
    </ng-template>
  </p-table>
</p-card>

<!-- Formulaire d'ajout et de modification d'un courriel  -->
<p-dialog
  header="Formulaire du courriel"
  [(visible)]="showFormDialog"
  (onHide)="cancel()"
  [style]="{ width: '60vw' }"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  class="p-fluid"
>
  <ng-template pTemplate="content">
    <div class="container py-5">
      <form [formGroup]="courielForm">
        <div class="col-12">
            <div class="p-fluid p-formgrid grid">
              <!--              Libelle          -->
              <div class="field col-12 md:col-6">
                <label for="libelle" class="font-medium text-900">Libelle</label>
                <input id="libelle" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="libelle"/>
                <mrt-form-validators
                  [entityField]="'libelle'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Source           -->
              <div class="field col-12 md:col-6">
                <label for="source" class="font-medium text-900">Source</label>
                <input id="source" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="source"/>
                <mrt-form-validators
                  [entityField]="'source'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Sens           -->
              <div class="field col-12 md:col-4">
                 <label for="sens" class="font-medium text-900">Sens</label>
                     <p-dropdown
                       id="sens"
                       formControlName="sens"
                       placeholder="Selectionner le sens"
                       >
                       </p-dropdown>
                       <mrt-form-validators
                          [entityField]="'sens'"
                          [formGroup]="courielForm"/>
              </div>

              <!--              Categorie           -->
              <div class="field col-12 md:col-4">
                <label for="categorie" class="font-medium text-900">Categorie</label>
                <p-dropdown
                  id="categorie"
                  formControlName="categorie"
                  placeholder="Selectionner la categorie"
                >
                </p-dropdown>
                <mrt-form-validators
                  [entityField]="'categorie'"
                  [formGroup]="courielForm"/>
              </div>

                <!--               Type               -->
              <div class="field col-12 md:col-4">
                <label for="type" class="font-medium text-900">Type</label>
                <p-dropdown
                  id="type"
                  formControlName="type"
                  placeholder="Selectionner le type"
                >
                </p-dropdown>
                <mrt-form-validators
                  [entityField]="'type'"
                  [formGroup]="courielForm"/>
              </div>

              <!--              Object           -->
              <div class="field col-12 md:col-6">
                <label for="object" class="font-medium text-900">Object</label>
                <input id="object" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="object"/>
                <mrt-form-validators
                  [entityField]="'object'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Numero Document           -->
              <div class="field col-12 md:col-6">
                <label for="numDoc" class="font-medium text-900">Numero Document</label>
                <input id="numDoc" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="numDoc"/>
                <mrt-form-validators
                  [entityField]="'numDoc'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Annotation           -->
              <div class="field col-12 md:col-6">
                <label for="annotation" class="font-medium text-900">Annotation</label>
                <input id="annotation" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="annotation"/>
                <mrt-form-validators
                  [entityField]="'annotation'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              SE           -->
              <div class="field col-12 md:col-6">
                <label for="se" class="font-medium text-900">SE</label>
                <input id="se" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="se"/>
                <mrt-form-validators
                  [entityField]="'se'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Designation           -->
              <div class="field col-12 md:col-6">
                <label for="designation" class="font-medium text-900">Designation</label>
                <input id="designation" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="designation"/>
                <mrt-form-validators
                  [entityField]="'designation'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Ventilation           -->
              <div class="field col-12 md:col-6">
                <label for="ventilation" class="font-medium text-900">Ventilation</label>
                <input id="ventilation" pInputText class="w-full p-component p-element form-control mb-1" type="text"
                       formControlName="ventilation"/>
                <mrt-form-validators
                  [entityField]="'ventilation'"
                  [formGroup]="courielForm"
                />
              </div>

              <!--              Date Ventilation           -->
              <div class="field col-12 md:col-6">
                <label for="dateVentilation" class="font-medium text-900">Date Ventilation</label>
                                <p-calendar
                                  id="dateVentilation"
                                  [dateFormat]="'yy-mm-dd'"
                                  placeholder="Entre la date(yyyy-mm-dd)"
                                  styleClass="mb-1"
                                  appendTo="body"
                                  [showTime]="false"
                                  formControlName="dateVentilation"
                                />
                                <mrt-form-validators
                                  [entityField]="'dateVentilation'"
                                  [formGroup]="courielForm"
                                />
              </div>

              <!--              Date couriel           -->
              <div class="field col-12 md:col-6">
                <label for="dateCouriel" class="font-medium text-900">Date Courriel</label>
                <p-calendar
                  id="dateCouriel"
                  [dateFormat]="'yy-mm-dd'"
                  placeholder="Entre la date(yyyy-mm-dd)"
                  styleClass="mb-1"
                  appendTo="body"
                  [showTime]="false"
                  formControlName="dateCouriel"
                />
                <mrt-form-validators
                  [entityField]="'dateCouriel'"
                  [formGroup]="courielForm"
                />
              </div>
              <!--              Observation           -->
              <div class="field col-12">
                <label for="observation" class="font-medium text-900">Observation</label>
                <textarea id="observation" pInputTextarea  required cols="20" formControlName="observation"></textarea>
                <mrt-form-validators
                  [entityField]="'observation'"
                  [formGroup]="courielForm"
                />
              </div>
            </div>
          </div>
      </form>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <button pButton pRipple
            class="p-button-primary flex-1"
            label="Enregistrer"
            icon="pi pi-fw pi-check"
            [disabled]="courielForm.invalid"
    >
    </button>
    <button pButton pRipple class="p-button-danger flex-1 p-button-outlined" label="Annuler"
            icon="pi pi-fw pi-times" (click)="cancel()"></button>
  </ng-template>
</p-dialog>
