<p-toast
  [showTransformOptions]="'translateY(100%)'"
  [showTransitionOptions]="'1000ms'"
  [hideTransitionOptions]="'1000ms'"
  [showTransformOptions]="'translateX(100%)'" />

<p-confirmDialog />

<div class="border-1 surface-border border-round p-fluid mb-4">
    <span class="text-900 font-bold block border-bottom-1 surface-border p-3">
        Critères de permuttation niveau national pour le premier agent
    </span>
    <div class="p-fluid p-formgrid grid m-2">
        <div class="grid col-6 md:col-6">
            <!--Matricule-->
        <div class="field col-12">
            <label for="matriculeMobilite">Matricule</label>
            <input
              type="text"
              pInputText
              id="matriculeMobilite"
              required
            />
        </div>

        <div class="field col-12">
            <label class="font-medium text-900">Libellé de la Pièce</label>
            <p-dropdown
        id="libelle"
        [options]="listeLibellePiece"
        [(ngModel)]="pieceLibelle"
              [ngModelOptions]="{standalone: true}"
        placeholder="Selectionner le libelle de la piece" />
            <!-- <input
              type="text"
              [(ngModel)]="pieceLibelle"
              [ngModelOptions]="{standalone: true}"
              pInputText
              id="libelle"
              /> -->
            <p-fileUpload #fileUpload (onUpload)="onUploadFile($event)" [customUpload]="true" (onSelect)="onUploadFile($event)" accept=".png,.jpg"  [showUploadButton]="false" [showCancelButton]="false" [auto]="true" styleClass="border-1 surface-border surface-card p-0 border-round m-2">
              <ng-template pTemplate="content">
                <div class="h-20rem m-1 border-round">
                  @if(!image){
                    <div class="flex flex-column w-full h-full justify-content-center align-items-center cursor-pointer" (click)="fileUpload.advancedFileInput.nativeElement.click()">
                      <i class="pi pi-fw pi-file text-4xl text-primary"></i>
                      <span class="block font-semibold text-900 text-lg mt-3">Déposer ou sélectionner une image</span>
                    </div>
                  }
                  @if(image){
                    <div class="w-full h-full relative border-round p-0">
                      <img [src]="image.objectURL" class="w-full h-full border-round" alt="blog cover">
                      <button pButton pRipple type="button" icon="pi pi-times" class="p-button-rounded p-button-primary text-sm absolute justify-content-center align-items-center" style="top: -10px; right: -10px;" (click)="$event.stopPropagation(); removeFile()"></button>
                    </div>
                  }
                </div>
              </ng-template>
            </p-fileUpload>
        </div>
          <button pButton=""
                  pRipple=""
                  (click)="ajouterAgent1()"
                  label="Ajouter"
                  icon="pi pi-plus"
                  class="p-element p-ripple p-button-outlined p-button-primary p-button p-component "
          >
          </button>
        </div>

        <div class="col-6">
            <p-table
            [columns]="colsDossier"
            [value]="listPieceJustificatifAgent1"
            #dt1
            dataKey="id"
            [rows]="5"
            [showCurrentPageReport]="true"
            currentPageReportTemplate="Page {currentPage} sur {totalPages}"
            [paginator]="true"
            styleClass="p-datatable-gridlines p-datatable-striped"
            responsiveLayout="scroll"
            [rowHover]="true"
            [rowsPerPageOptions]="[5,10]"
            tableStyleClass="p-datatable-gridlines"
          >
            <ng-template let-columns pTemplate="header">
              <tr>
                @for (col of columns; track col.field) {
                  <th
                    style="min-width: 15rem"
                    [pSortableColumn]="col.field"
                    class="font-weight-bold"
                  >
                    {{ col.header }}
                    <p-sortIcon [field]="col.field"></p-sortIcon>
                  </th>
                }
                <th>Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-piece>
              <tr>
                <td>{{ piece.libelle }}</td>
                <td>
                  <div class="flex flex-column w-2 justify-content-between" style="row-gap: 1rem;"></div>
                  <img  [src]="piece.images.objectURL" alt=""
                       class="w-10rem  shadow-4">
                </td>
                <td>
                <!--          Bouton pour supprimer un element de la liste -->
                <button
                pButton
                type="button"
                pTooltip="Retirer"
                tooltipPosition="top"
                pRipple
                icon="pi pi-trash"
                class="p-button-rounded p-button-danger mx-2"
                iconPos="left"
                (click)="removePieceAgent1(piece)"
              ></button>
            </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="8">Aucun élement.</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
    </div>
</div>

<p-divider></p-divider>

<div class="border-1 surface-border border-round p-fluid mb-4">
    <span class="text-900 font-bold block border-bottom-1 surface-border p-3">
        Critères de permuttation niveau national pour le deuxieme agent
    </span>
    <div class="p-fluid p-formgrid grid m-2">
        <div class="grid col-6 md:col-6">
            <!--Matricule-->
        <div class="field col-12">
            <label for="matriculeMobilite">Matricule</label>
            <input
              type="text"
              pInputText
              id="matriculeMobilite"
              required
            />
        </div>

        <div class="field col-12">
            <label class="font-medium text-900">Libellé de la Pièce</label>
            <p-dropdown
        id="libelle"
        [options]="listeLibellePiece"
        [(ngModel)]="pieceLibelle"
              [ngModelOptions]="{standalone: true}"
        placeholder="Selectionner le libelle de la piece" />
            <p-fileUpload #fileUpload (onUpload)="onUploadFile($event)" [customUpload]="true" (onSelect)="onUploadFile($event)" accept=".png,.jpg"  [showUploadButton]="false" [showCancelButton]="false" [auto]="true" styleClass="border-1 surface-border surface-card p-0 border-round m-2">
              <ng-template pTemplate="content">
                <div class="h-20rem m-1 border-round">
                  @if(!image){
                    <div class="flex flex-column w-full h-full justify-content-center align-items-center cursor-pointer" (click)="fileUpload.advancedFileInput.nativeElement.click()">
                      <i class="pi pi-fw pi-file text-4xl text-primary"></i>
                      <span class="block font-semibold text-900 text-lg mt-3">Déposer ou sélectionner une image</span>
                    </div>
                  }
                  @if(image){
                    <div class="w-full h-full relative border-round p-0">
                      <img [src]="image.objectURL" class="w-full h-full border-round" alt="blog cover">
                      <button pButton pRipple type="button" icon="pi pi-times" class="p-button-rounded p-button-primary text-sm absolute justify-content-center align-items-center" style="top: -10px; right: -10px;" (click)="$event.stopPropagation(); removeFile()"></button>
                    </div>
                  }
                </div>
              </ng-template>
            </p-fileUpload>
        </div>
          <button pButton=""
                  pRipple=""
                  (click)="ajouterAgent2()"
                  label="Ajouter"
                  icon="pi pi-plus"
                  class="p-element p-ripple p-button-outlined p-button-primary p-button p-component "
          >
          </button>
        </div>

        <div class="col-6">
            <p-table
            [columns]="colsDossier"
            [value]="listPieceJustificatifAgent2"
            #dt1
            dataKey="id"
            [rows]="5"
            [showCurrentPageReport]="true"
            currentPageReportTemplate="Page {currentPage} sur {totalPages}"
            [paginator]="true"
            styleClass="p-datatable-gridlines p-datatable-striped"
            responsiveLayout="scroll"
            [rowHover]="true"
            [rowsPerPageOptions]="[5,10]"
            tableStyleClass="p-datatable-gridlines"
          >
            <ng-template let-columns pTemplate="header">
              <tr>
                @for (col of columns; track col.field) {
                  <th
                    style="min-width: 15rem"
                    [pSortableColumn]="col.field"
                    class="font-weight-bold"
                  >
                    {{ col.header }}
                    <p-sortIcon [field]="col.field"></p-sortIcon>
                  </th>
                }
                <th>Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-piece>
              <tr>
                <td>{{ piece.libelle }}</td>
                <td>
                  <div class="flex flex-column w-2 justify-content-between" style="row-gap: 1rem;"></div>
                  <img  [src]="piece.images.objectURL" alt=""
                       class="w-10rem  shadow-4">
                </td>
                <td>
                <!--          Bouton pour supprimer un element de la liste -->
                <button
                pButton
                type="button"
                pTooltip="Retirer"
                tooltipPosition="top"
                pRipple
                icon="pi pi-trash"
                class="p-button-rounded p-button-danger mx-2"
                iconPos="left"
                (click)="removePieceAgent2(piece)"
              ></button>
            </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="8">Aucun élement.</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
    </div>
</div>